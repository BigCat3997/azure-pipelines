parameters:
  - name: workDir
    displayName: Working directory
    type: string

  - name: appDir
    displayName: Application directory
    type: string

  - name: javaVersion
    displayName: Java's version
    type: number
    default: 17
    values:
      - 8
      - 11
      - 17

  - name: isUseFeed
    displayName: Connect to Azure Feed
    type: boolean
    default: false

  - name: mavenOpts
    displayName: Maven opts
    type: string
    default: ''

  - name: mavenGoals
    displayName: Maven goals
    type: string
    default: 'clean install -B -e'

  - name: preSteps
    type: stepList
    default: []

  - name: postSteps
    type: stepList
    default: []

steps:
  - ${{ parameters.preSteps }}

  - task: JavaToolInstaller@0
    inputs:
      versionSpec: '11'
      jdkArchitectureOption: 'x64'
      jdkSourceOption: 'PreInstalled'

  # - ${{ if eq(parameters.isConnectToFeed, true) }}:
  #     - task: MavenAuthenticate@0
  #       displayName: 'Maven Authenticate'
  #       inputs:
  #         artifactsFeeds: devops-feed

  # - task: Maven@4
  #   inputs:
  #     mavenPOMFile: '${{ parameters.appDir }}/pom.xml'
  #     goals: ${{ parameters.mavenGoals }}
  #     testResultsFiles: '**/surefire-reports/TEST-*.xml'
  #     javaHomeOption: 'JDKVersion'
  #     jdkVersionOption: '1.11'
  #     jdkArchitectureOption: 'x64'
  #     mavenVersionOption: 'Path'
  #     mavenDirectory: '${{ parameters.mavenTargetMountDir }}'
  #     mavenSetM2Home: true
  #     mavenOptions: '-Xmx1024m $(getterVariables.MAVEN_OPTS)'
  #     mavenAuthenticateFeed: ${{ parameters.isConnectToFeed }}

  - ${{ parameters.poseSteps }}
